## 死锁

### 什么是死锁

死锁：两个或两个以上的进程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去，此时称系统处于死锁状态或系统产生了死锁，
这些永远在互相等待的进程称为死锁进程。

### 例子

进程X持有资源a，正在申请资源b，进程Y持有资源b，正在申请资源a；都因为资源被其他进程持有而陷入等待，而且会无限制的等待下去

### 产生死锁的原因

* 系统资源不足
* 进程运行推进的顺序不合适
* 资源分配不当

### 死锁的必要条件

* 互斥条件：一个资源每次只能被一个进程使用
* 请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放
* 不剥夺条件：进程已获得的资源，在未使用完之前，不能被剥夺，只能在使用完时由自己释放
* 循环等待条件：若干个进程之间形成一种头尾相接的循环等待资源的关系

这四个条件是死锁的必要条件，只要系统发生死锁，这些条件必然成立，而只要上述条件之一不满足，就不会产生死锁。

### 如何避免死锁

* 加锁顺序(多个线程都是按照相同的顺序获得锁)
* 加锁时限(线程尝试获取锁的时候加上一定的时限，超过时限则放弃对该锁的请求，并释放自己占有的锁)
* 死锁检测

## 参考

* [避免死锁](http://ifeve.com/deadlock-prevention/)

